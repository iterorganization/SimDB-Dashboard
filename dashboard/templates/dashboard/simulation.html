{% extends 'base.html' %}

{% block body %}
<div id="app">
  <v-app>
    <auth-dialog :server="server" :show="dialog" @ok="setItems" @error="dialog = false"></auth-dialog>

    <v-system-bar app dark color="indigo">
      ITER Simulation Database
      <v-spacer></v-spacer>
      Version 0.1
    </v-system-bar>

    <v-app-bar app shrink-on-scroll dark color="indigo darken-2" height="80" dense>
      <v-spacer></v-spacer>
      <v-toolbar-title class="d-flex align-center" style="height: 100%">
        <v-btn text href="/dashboard" class="text-none text-h4" style="letter-spacing: 0; color: white !important;">SimDB Dashboard</v-btn>
      </v-toolbar-title>
      <v-spacer></v-spacer>
    </v-app-bar>

    <v-main>
      <v-container fluid>
        <v-row v-for="item in displayHeaders" :key="item.label" dense>
          <v-col cols="2" class="text-h5"><[ item.label ]></v-col>
          <v-col cols="10" class="text-h5"><[ valueFor(item.value) ]></v-col>
        </v-row>
        <v-row>
          <v-divider></v-divider>
        </v-row>
        <v-row>
          <v-col>
          <v-subheader class="text-h5">Metadata</v-subheader>
          <v-simple-table>
            <template>
              <thead><tr><th class="pl-1">Key</th><th class="pl-2">Value</th></tr></thead>
              <tbody>
                <data-row v-for="(name, index) in displayItems" :key="index" :name="name" :value="getValue(name)" :index="index" :data="items"></data-row>
                <div v-if="!showAllFields">
                  <row-adder :server="server" @add="addRow" @remove="removeRow" @reset="resetRows"></row-adder>
                </div>
              </tbody>
            </template>
          </v-simple-table>
            </v-col>
        </v-row>
        <v-row>
          <v-col>
          <v-subheader class="text-h5">Inputs</v-subheader>
          <v-simple-table>
            <template>
              <thead><tr><th class="pl-1">URI</th><th class="pl-2">Creation Time</th></thead>
              <tbody>
                <tr v-for="input in inputs" :key="input.uuid.hex">
                  <td><[ input.uri ]></td>
                  <td><[ (new Date(input.datetime)).toUTCString() ]></td>
                </tr>
              </tbody>
              </tbody>
            </template>
          </v-simple-table>
          </v-col>
        </v-row>
        <v-row>
          <v-col>
          <v-subheader class="text-h5">Outputs</v-subheader>
          <v-simple-table>
            <template>
              <thead><tr><th class="pl-1">URI</th><th class="pl-2">Creation Time</th></thead>
              <tbody>
                <tr v-for="output in outputs" :key="output.uuid.hex">
                  <td><[ output.uri ]></td>
                  <td><[ (new Date(output.datetime)).toUTCString() ]></td>
                </tr>
              </tbody>
            </template>
          </v-simple-table>
          </v-col>
        </v-row>
      </v-container>
    </v-main>
  </v-app>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='dashboard/js/plotly.js') }}"></script>
<script src="{{ url_for('static', filename='dashboard/js/data-row.js') }}"></script>
<script src="{{ url_for('static', filename='dashboard/js/auth-dialog.js') }}"></script>
<script src="{{ url_for('static', filename='dashboard/js/row-adder.js') }}"></script>
<script src="{{ url_for('static', filename='dashboard/js/simulation.js') }}"></script>
{% endblock %}
